# フォームUI仕様書（入力項目・バリデーション仕様書）

## プロジェクト: ユーザー管理システム
**作成日**: 2025-11-15
**バージョン**: 1.0

---

## 1. ユーザー登録フォーム

### 1.1 フォーム概要
- **フォーム名**: ユーザー登録フォーム
- **用途**: 新規ユーザーアカウント作成
- **送信方式**: POST /api/users

### 1.2 入力項目仕様

#### 1.2.1 姓（lastName）
| 項目 | 内容 |
|------|------|
| **フィールド名** | lastName |
| **ラベル** | 姓 |
| **入力タイプ** | text |
| **必須** | ○ |
| **最小文字数** | 1 |
| **最大文字数** | 50 |
| **プレースホルダー** | "山田" |
| **初期値** | 空文字 |
| **バリデーション** | ・必須チェック<br>・1文字以上50文字以内<br>・全角・半角可 |
| **エラーメッセージ** | ・"姓を入力してください"（必須エラー）<br>・"姓は50文字以内で入力してください"（文字数超過） |
| **リアルタイムバリデーション** | onBlur（フォーカスアウト時） |

#### 1.2.2 名（firstName）
| 項目 | 内容 |
|------|------|
| **フィールド名** | firstName |
| **ラベル** | 名 |
| **入力タイプ** | text |
| **必須** | ○ |
| **最小文字数** | 1 |
| **最大文字数** | 50 |
| **プレースホルダー** | "太郎" |
| **初期値** | 空文字 |
| **バリデーション** | ・必須チェック<br>・1文字以上50文字以内<br>・全角・半角可 |
| **エラーメッセージ** | ・"名を入力してください"（必須エラー）<br>・"名は50文字以内で入力してください"（文字数超過） |
| **リアルタイムバリデーション** | onBlur（フォーカスアウト時） |

#### 1.2.3 メールアドレス（email）
| 項目 | 内容 |
|------|------|
| **フィールド名** | email |
| **ラベル** | メールアドレス |
| **入力タイプ** | email |
| **必須** | ○ |
| **最小文字数** | 3 |
| **最大文字数** | 254 |
| **プレースホルダー** | "example@example.com" |
| **初期値** | 空文字 |
| **バリデーション** | ・必須チェック<br>・Email形式チェック（RFC 5322準拠）<br>・3文字以上254文字以内<br>・重複チェック（サーバー側） |
| **正規表現** | `^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$` |
| **エラーメッセージ** | ・"メールアドレスを入力してください"（必須エラー）<br>・"正しいメールアドレス形式で入力してください"（形式エラー）<br>・"このメールアドレスは既に登録されています"（重複エラー） |
| **リアルタイムバリデーション** | onChange（入力中）+ onBlur（重複チェック） |

#### 1.2.4 パスワード（password）
| 項目 | 内容 |
|------|------|
| **フィールド名** | password |
| **ラベル** | パスワード |
| **入力タイプ** | password |
| **必須** | ○ |
| **最小文字数** | 8 |
| **最大文字数** | 128 |
| **プレースホルダー** | "8文字以上の英数字記号" |
| **初期値** | 空文字 |
| **表示切替** | 表示/非表示トグルボタンあり |
| **バリデーション** | ・必須チェック<br>・8文字以上128文字以内<br>・英大文字を1文字以上含む<br>・英小文字を1文字以上含む<br>・数字を1文字以上含む<br>・記号を1文字以上含む |
| **正規表現** | `^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,128}$` |
| **エラーメッセージ** | ・"パスワードを入力してください"（必須エラー）<br>・"パスワードは8文字以上で入力してください"（文字数不足）<br>・"パスワードは英大文字、英小文字、数字、記号をそれぞれ1文字以上含めてください"（複雑度不足） |
| **パスワード強度表示** | 弱/中/強の3段階インジケーター表示 |
| **リアルタイムバリデーション** | onChange（入力中） |

#### 1.2.5 パスワード（確認）（passwordConfirm）
| 項目 | 内容 |
|------|------|
| **フィールド名** | passwordConfirm |
| **ラベル** | パスワード（確認） |
| **入力タイプ** | password |
| **必須** | ○ |
| **最小文字数** | 8 |
| **最大文字数** | 128 |
| **プレースホルダー** | "パスワードを再入力" |
| **初期値** | 空文字 |
| **表示切替** | 表示/非表示トグルボタンあり |
| **バリデーション** | ・必須チェック<br>・パスワードフィールドと一致 |
| **エラーメッセージ** | ・"パスワード（確認）を入力してください"（必須エラー）<br>・"パスワードが一致しません"（不一致エラー） |
| **リアルタイムバリデーション** | onChange（入力中） |

#### 1.2.6 生年月日（birthDate）
| 項目 | 内容 |
|------|------|
| **フィールド名** | birthDate |
| **ラベル** | 生年月日 |
| **入力タイプ** | date |
| **必須** | ○ |
| **プレースホルダー** | "yyyy-MM-dd" |
| **初期値** | 空文字 |
| **バリデーション** | ・必須チェック<br>・日付形式チェック（yyyy-MM-dd）<br>・過去日付チェック<br>・13歳以上チェック<br>・120歳以下チェック |
| **エラーメッセージ** | ・"生年月日を入力してください"（必須エラー）<br>・"正しい日付形式で入力してください"（形式エラー）<br>・"13歳未満の方はご利用いただけません"（年齢制限）<br>・"生年月日を正しく入力してください"（不正な日付） |
| **リアルタイムバリデーション** | onBlur（フォーカスアウト時） |

#### 1.2.7 性別（gender）
| 項目 | 内容 |
|------|------|
| **フィールド名** | gender |
| **ラベル** | 性別 |
| **入力タイプ** | radio |
| **必須** | - |
| **選択肢** | ・male: 男性<br>・female: 女性<br>・other: その他<br>・prefer_not_to_say: 回答しない |
| **初期値** | 未選択 |
| **バリデーション** | なし（任意項目） |
| **エラーメッセージ** | なし |
| **リアルタイムバリデーション** | なし |

#### 1.2.8 利用規約同意（termsAgreed）
| 項目 | 内容 |
|------|------|
| **フィールド名** | termsAgreed |
| **ラベル** | 利用規約に同意する |
| **入力タイプ** | checkbox |
| **必須** | ○ |
| **初期値** | false（未チェック） |
| **バリデーション** | ・必須チェック（チェック必須） |
| **エラーメッセージ** | ・"利用規約に同意してください"（未チェックエラー） |
| **リアルタイムバリデーション** | onChange（変更時） |
| **備考** | 利用規約リンクを別タブで開く |

---

## 2. ユーザー編集フォーム

### 2.1 フォーム概要
- **フォーム名**: ユーザー編集フォーム
- **用途**: 既存ユーザー情報更新
- **送信方式**: PUT /api/users/:id

### 2.2 入力項目仕様

#### 2.2.1 姓（lastName）
※ユーザー登録フォームと同様

#### 2.2.2 名（firstName）
※ユーザー登録フォームと同様

#### 2.2.3 メールアドレス（email）
※ユーザー登録フォームと同様
**差分**: 重複チェック時に自分自身のIDは除外

#### 2.2.4 生年月日（birthDate）
※ユーザー登録フォームと同様

#### 2.2.5 性別（gender）
※ユーザー登録フォームと同様

#### 2.2.6 ステータス（status）
| 項目 | 内容 |
|------|------|
| **フィールド名** | status |
| **ラベル** | ステータス |
| **入力タイプ** | radio |
| **必須** | ○ |
| **選択肢** | ・active: アクティブ<br>・inactive: 停止中 |
| **初期値** | DB値 |
| **バリデーション** | ・必須チェック |
| **エラーメッセージ** | ・"ステータスを選択してください"（必須エラー） |
| **リアルタイムバリデーション** | onChange（変更時） |

---

## 3. ログインフォーム

### 3.1 フォーム概要
- **フォーム名**: ログインフォーム
- **用途**: ユーザー認証
- **送信方式**: POST /api/auth/login

### 3.2 入力項目仕様

#### 3.2.1 メールアドレス（email）
| 項目 | 内容 |
|------|------|
| **フィールド名** | email |
| **ラベル** | メールアドレス |
| **入力タイプ** | email |
| **必須** | ○ |
| **最大文字数** | 254 |
| **プレースホルダー** | "example@example.com" |
| **初期値** | 空文字（Cookie保存の場合は復元） |
| **バリデーション** | ・必須チェック<br>・Email形式チェック |
| **エラーメッセージ** | ・"メールアドレスを入力してください"（必須エラー）<br>・"正しいメールアドレス形式で入力してください"（形式エラー） |
| **リアルタイムバリデーション** | onBlur（フォーカスアウト時） |

#### 3.2.2 パスワード（password）
| 項目 | 内容 |
|------|------|
| **フィールド名** | password |
| **ラベル** | パスワード |
| **入力タイプ** | password |
| **必須** | ○ |
| **最大文字数** | 128 |
| **プレースホルダー** | "パスワード" |
| **初期値** | 空文字 |
| **表示切替** | 表示/非表示トグルボタンあり |
| **バリデーション** | ・必須チェック |
| **エラーメッセージ** | ・"パスワードを入力してください"（必須エラー）<br>・"メールアドレスまたはパスワードが正しくありません"（認証エラー） |
| **リアルタイムバリデーション** | なし（送信時のみ） |

#### 3.2.3 ログイン状態を保持（rememberMe）
| 項目 | 内容 |
|------|------|
| **フィールド名** | rememberMe |
| **ラベル** | ログイン状態を保持する |
| **入力タイプ** | checkbox |
| **必須** | - |
| **初期値** | false（未チェック） |
| **バリデーション** | なし |
| **備考** | チェック時はCookie有効期限30日 |

---

## 4. 共通バリデーションルール

### 4.1 クライアント側バリデーション
- 入力中のリアルタイムバリデーション（onChange）
- フォーカスアウト時のバリデーション（onBlur）
- 送信時の全項目バリデーション（onSubmit）
- エラーメッセージは入力欄の下に赤文字で表示
- エラーがある項目は赤枠で囲む

### 4.2 サーバー側バリデーション
- クライアント側と同様のバリデーションを実施
- 重複チェック、権限チェックなどDB依存のバリデーション
- サーバーエラーはフォーム上部にまとめて表示

### 4.3 エラー表示優先順位
1. 必須エラー
2. 形式エラー
3. 文字数エラー
4. 重複エラー
5. ビジネスロジックエラー

### 4.4 送信ボタン制御
- バリデーションエラーがある場合は送信ボタンを無効化
- 送信中はローディングスピナー表示
- 二重送信防止のため送信中はボタンを無効化

---

## 5. アクセシビリティ対応

### 5.1 ARIA属性
- `aria-required="true"`: 必須項目
- `aria-invalid="true"`: エラーがある項目
- `aria-describedby`: エラーメッセージとの関連付け
- `role="alert"`: エラーメッセージ

### 5.2 キーボード操作
- Tabキーでのフォーカス移動
- Enterキーでの送信
- Escキーでのモーダルクローズ

### 5.3 ラベル
- すべての入力欄に`<label>`要素を使用
- `for`属性でinputと関連付け

---

## 6. レスポンシブ対応

### 6.1 ブレークポイント
- モバイル: 〜767px
- タブレット: 768px〜1023px
- デスクトップ: 1024px〜

### 6.2 モバイル最適化
- 入力欄のフォントサイズ16px以上（ズーム防止）
- タップ領域44px以上
- 適切なinputmode属性（email, numeric等）

---

## 変更履歴

| バージョン | 日付 | 変更者 | 変更内容 |
|------------|------|--------|----------|
| 1.0 | 2025-11-15 | 設計チーム | 初版作成 |
